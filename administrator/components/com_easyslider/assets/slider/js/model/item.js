void function(exports,$,_,Backbone){exports.JSNES_XYZData=Backbone.Model.extend({defaults:{x:0,y:0,z:0},initialize:function(){this.on("change",function(){_(this.changed).each(function(value,key){_.isNumber(value)||(this.attributes[key]=parseFloat(value));_.isNaN(this.attributes[key])&&(this.attributes[key]=this.defaults[key])},this)})},toJSON:function(){var o={};_.isNumber(this.attributes.x)&&this.attributes.x!=this.defaults.x&&(o.x=this.attributes.x);_.isNumber(this.attributes.y)&&this.attributes.y!=this.defaults.y&&(o.y=this.attributes.y);_.isNumber(this.attributes.z)&&this.attributes.z!=this.defaults.z&&(o.z=this.attributes.z);return o},resetToDefault:function(){this.set(_.result(this,"defaults"),{silent:true})}});exports.JSNES_TransformData=Backbone.Model.extend({defaults:{opacity:"0",origin:{},translate:{},rotate:{},scale:{},skew:{}},relations:{origin:JSNES_XYZData.extend({defaults:{x:.5,y:.5}}),translate:JSNES_XYZData.extend({defaults:{x:0,y:0,z:0}}),rotate:JSNES_XYZData.extend({defaults:{x:0,y:0,z:0}}),scale:JSNES_XYZData.extend({defaults:{x:1,y:1,z:1}}),skew:JSNES_XYZData.extend({defaults:{x:0,y:0}})},resetDefaults:function(){_(["origin","translate","rotate","scale","skew"]).each(_.bind(function(attr){this.get(attr).resetToDefault()},this))}});exports.JSNES_ImageData=Backbone.Model.extend({defaults:{type:"local",url:""},initialize:function(){this.check();this.on("change:url",this.check)},check:function(){var url=this.get("url");if(url==="")return this.set("type","placeholder",{silent:true});if(!url.match(/^(http|https)?:?\/\/([^\/]+)(\/.*)/))return this.set("type","local",{silent:true});return this.set("type","extend",{silent:true})}});exports.JSNES_VideoData=Backbone.Model.extend({defaults:{type:"youtube",url:"",volume:.8,autoplay:true,loop:false,controls:false},initialize:function(){this.on("change:url",this.check);this.check()},check:function(){var url=this.get("url");if(url==="")return this.set("type","placeholder",{silent:true});if(!url.match(/^(http|https)?:?\/\/([^\/]+)(\/.*)/))return this.set("type","local",{silent:true});if(url.match(/youtube.com\/|youtu.be\//))return this.set("type","youtube",{silent:true});if(url.match(/vimeo.com\//))return this.set("type","vimeo",{silent:true});return this.set("type","external",{silent:true})}});exports.JSNES_SlideTransitionData=Backbone.Model.extend({defaults:{type:1,effect:"fade",delay:5e3,duration:1e3,timing:"ease",rows:1,cols:4,delayRandom:false,delayY:100,delayX:100,cubeDepth:"auto",cubeAnimation:"scale-rotate",cubeFace:"right",cubeAxis:"x",cubeRotate:-1}});exports.JSNES_ItemData=Backbone.Model.extend({constructor:function JSNES_Item(){Object.defineProperty(this,"sliderModel",{get:function(){return exports.slider.model}});Backbone.Model.apply(this,arguments)},initialize:function(data){this.inStart=this.get("build.inStart");this.inEnd=this.get("build.inEnd");this.outStart=this.get("build.outStart");this.outEnd=this.get("build.outEnd")},defaults:function(){return{index:0,type:"item",tagName:"DIV",content:"",selected:false,show:true,lock:false,origin:"0,0",style:{},style_T:{},style_M:{},build:{}}},getOrigin:function(){return this.get("origin").split(",").map(function(val){return parseFloat(val)})},getStyle:function(key){var styles;switch(this.sliderModel.get("responsiveEditMode")){case"default":case"desktop":styles=_({}).extend(this.get("style").attributes);break;case"tablet":styles=_({}).extend(this.get("style").attributes,this.get("style_T").attributes);break;case"mobile":styles=_({}).extend(this.get("style").attributes,this.get("style_M").attributes);break}return key?styles[key]:styles},setStyle:function(key,value){switch(this.sliderModel.get("responsiveEditMode")){case"default":case"desktop":return this.get("style").set(key,value);break;case"tablet":return this.get("style_T").set(key,value);break;case"mobile":return this.get("style_M").set(key,value);break}},relations:{video:JSNES_VideoData,image:JSNES_ImageData,style:Backbone.Model.extend({defaults:{visibility:"visible"}}),style_T:Backbone.Model.extend({defaults:{visibility:"visible"}}),style_M:Backbone.Model.extend({defaults:{visibility:"visible"}}),build:Backbone.Model.extend({defaults:{inEffect:"",inStart:0,inEnd:0,inEasing:"linear",inTransform:{},outEffect:"",outStart:5e3,outEnd:5e3,outEasing:"linear",outTransform:{}},relations:{inTransform:JSNES_TransformData,outTransform:JSNES_TransformData},initialize:function(){Object.defineProperty(this,"slideModel",{get:function(){return this.parent&&this.parent.collection&&this.parent.collection.parent}});this.on("change",this.validate);this.on("change:inStart",function(){if(this.get("inStart")>this.get("outStart"))this.set("inStart",this.get("outStart"),{silent:true});if(this.get("inStart")>this.get("inEnd"))this.set("inEnd",this.get("inStart"),{silent:true});if(this.get("inStart")>this.get("outStart"))this.set("inStart",this.get("outStart"),{silent:true})});this.on("change:inEnd",function(){if(this.get("inEnd")>this.get("outStart"))this.set("inEnd",this.get("outStart"),{silent:true});if(this.get("inEnd")<this.get("inStart"))this.set("inStart",this.get("inEnd"),{silent:true})});this.on("change:outStart",function(){if(this.get("outStart")<this.get("inEnd"))this.set("outStart",this.get("inEnd"),{silent:true});if(this.get("outStart")>this.get("outEnd"))this.set("outEnd",this.get("outStart"),{silent:true})});this.on("change:outEnd",function(){if(this.get("outEnd")<this.get("inStart"))this.set("outEnd",this.get("inStart"),{silent:true});if(this.get("outEnd")<this.get("inEnd"))this.set("inEnd",this.get("outEnd"),{silent:true});if(this.get("outEnd")<this.get("outStart"))this.set("outStart",this.get("outEnd"),{silent:true})})},validate:function(){var model=this;if(this.slideModel){_(["inStart","inEnd","outStart","outEnd"]).each(function(key){var value=parseInt(this.get(key));var slideDelay=this.slideModel.get("transition").get("delay");this.set(key,Math.round(value/100)*100,{silent:true});if(value>slideDelay){this.set(key,slideDelay,{silent:true})}},this)}_.each(this.changed,function(value,key){if(this.parent&&(key=="inStart"||key=="outEnd")){this.parent.trigger("change:in:out:time")}if(key.indexOf("in")==0){model.trigger("preview:animation","in")}if(key.indexOf("out")==0){model.trigger("preview:animation","out")}},this)}})}});exports.JSNES_ItemDefaults={text:{type:"text",textType:"caption",origin:"0.5,0.5",content:"Double-click to edit",style:{top:"50%",left:"50%",width:"250px",height:"50px",color:"#000",fontFamily:"Open Sans",fontSize:"24px",fontWeight:"normal",lineHeight:"1em",textAlign:"center",verticalAlign:"middle"}},video:{type:"video",name:"Video Item",origin:"0.5,0.5",video:{type:"local",url:null},style:{top:"50%",left:"50%",width:"300px",height:"200px"}},image:{type:"image",name:"Image Item",origin:"0.5,0.5",image:{type:"image",url:""},style:{top:"50%",left:"50%",width:"200px",height:"150px"}},html:{v:1,type:"html",name:"HTML Item",origin:"0.5,0.5",style:{top:"50%",left:"50%",width:"300px"}}};exports.JSNES_ItemDefaults["text-list"]=_.deepExtend({},exports.JSNES_ItemDefaults.text,{textType:"list",tagName:"UL",content:"<li>Double-click here to edit</li>",style:{width:"300px",height:"60px",padding:"5px",textAlign:"left",verticalAlign:"top",fontSize:"14px",lineHeight:"1.5em",listStyleType:"circle"}});exports.JSNES_ItemDefaults["text-paragraph"]=_.deepExtend({},exports.JSNES_ItemDefaults.text,{textType:"paragraph",tagName:"DIV",content:"<p>Double-click here to edit</p>",style:{width:"300px",padding:"5px",textAlign:"left",verticalAlign:"top",fontSize:"12px",lineHeight:"1.5em"}})}(this,JSNES_jQuery,JSNES_Underscore,JSNES_Backbone);