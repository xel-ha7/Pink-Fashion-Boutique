void function(exports,$,_,Backbone){exports.JSNES_ThumbView=Backbone.ItemView.extend({tagName:"LI",className:"jsn-es-thumb jsn-es-animated",template:"#thumbview-template",events:{select:"select",deselect:"deselect",click:"select","click .remove-slide":"removeSlide","click .duplicate-slide":"duplicateSlide"},constructor:function JSNES_ThumbView(){Backbone.ItemView.apply(this,arguments)},initialize:function(){this.uriPrefix=$(".jsn-es-app").attr("data-uri");Object.defineProperty(this,"sliderView",{get:function(){return this.superView.superView}});this.render()},ready:function(){this.$el.addClass("thumb-ready");this.listenTo(this.model,"change:backgroundPosition",this.update);this.listenTo(this.model,"change:backgroundSize",this.update);this.listenTo(this.model,"change:backgroundColor",this.update);this.listenTo(this.model.get("backgroundImage"),"change",this.update);this.listenTo(this.model,"change:active",this.update);this.updateIndex();this.update()},select:function(){this.model.set("active",true);this.$el.siblings(".ui-selected").trigger("deselect");return this},deselect:function(){this.model.set("active",false);return this},update:function(){this.$el[this.model.get("active")?"addClass":"removeClass"]("ui-selected");if(!this.model.get("backgroundImage.url"))return this.$(".thumb-preview").css({backgroundSize:"",background:this.model.get("backgroundColor")});var bgURL=this.model.get("backgroundImage.type")=="extend"?this.model.get("backgroundImage.url"):_.joinPath(this.uriPrefix,this.model.get("backgroundImage.url"));this.$(".thumb-preview").css("background-image",this.model.get("backgroundImage.url")?"url("+bgURL+")":"").css(this.model.pick("backgroundPosition","backgroundSize","backgroundColor"));return this},updateIndex:function(){this.model.set("index",this.$el.index());return this},duplicateSlide:function(){if(typeof this._duplicateSlide==="function"){this._duplicateSlide.apply(this,arguments);_.delay(_.bind(function(){this.superView.$(".jsn-es-thumb:not(.add-slide)").last().trigger("select")},this),10)}},removeSlide:function(){if(confirm(JSNES_TEXT.DELETE_SLIDE_CONFIRM)){if(this.$el.next(".jsn-es-thumb:not(.add-slide)").length)this.$el.next(".jsn-es-thumb:not(.add-slide)").trigger("click");else if(this.$el.prev(".jsn-es-thumb:not(.add-slide)").length)this.$el.prev(".jsn-es-thumb:not(.add-slide)").trigger("click");this.model.collection.remove(this.model)}}});exports.JSNES_ThumbsView=Backbone.CollectionView.extend({itemView:JSNES_ThumbView,events:{sortupdate:"update",sortchange:"update"},constructor:function JSNES_ThumbsView(){Backbone.CollectionView.apply(this,arguments)},initialize:function(){this.listenTo(this.collection,"add",this.update);this.listenTo(this.collection,"remove",this.update);this.on("add:multiple",this.update);this.on("sort",this.moveAddBtnToEnd);this.changeHandler=_.debounce(this.changeHandler)},ready:function(){this.$el.sortable({containment:"parent",tolerance:"pointer",axis:"y",handle:".drag-handle"});this.$el.disableSelection();this.update();this.listenTo(this.collection,"change",this.changeHandler);this.listenTo(this.collection,"add",this.changeHandler);this.listenTo(this.collection,"remove",this.changeHandler)},changeHandler:function(){this.superView.trigger("change")},update:function(){this.moveAddBtnToEnd();this.updateIndex();return this},moveAddBtnToEnd:function(){this.$(".add-slide").appendTo(this.el);return this},updateIndex:function(){_(this.subViews).invoke("updateIndex");this.collection.sort().trigger("change");return this}})}(this,JSNES_jQuery,JSNES_Underscore,JSNES_Backbone);